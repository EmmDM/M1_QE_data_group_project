---
title: "Final Part"
author: "Victoire Truchon-Bartès & Emmanuel de MOREL"
format: html
echo : false
---


```{r, echo=FALSE}
# Sélection des librairies
suppressWarnings({suppressMessages(library(here))
suppressMessages(library(dplyr))
library(tidyr)
library(knitr)
library(ggplot2)
library(readr)
library(stringr)
library(readxl)})
```

```{r}
#On lit les bases de données OCDE_pays et non_OCDE_pays
donnees_partage <- readRDS("donnees_partage.RDS")
OCDE_pays <- donnees_partage$OCDE_pays
non_OCDE_pays <- donnees_partage$non_OCDE_pays
```

*I- Découplage* 

Dans un premier temps, nous chercherons à présenter un
état des lieux en déterminant les liens fondamentaux entre les
principaux agrégats économiques et environnementaux tels que le PIB, et
les émissions de CO2 pour notamment étudier dans quelle mesure la
croissance économique s'est découplée de l'impact environnemental. Nous
nous intéresserons à la notion de découplage, signifiant une croissance
économique sans augmentation proportionnelle de la pression
environnementale. Nous analyserons aussi les tendances en matière
d'intensité carbone et d'efficacité énergétique.

I.

Le découplage se produit lorsque le taux de croissance d'une pression
environnementale est inférieur à celui de sa force motrice économique
(par exemple le PIB) sur une période donnée. Le découplage peut être
absolu ou relatif. On parle de découplage absolu lorsque la variable
pertinente pour l'environnement est stable ou décroissante alors que la
force motrice économique augmente. Le découplage est dit relatif lorsque
le taux de croissance de la variable pertinente pour l'environnement est
positif, mais inférieur au taux de croissance de la variable économique.

Il existe un nombre varié d'indicateur de découplage, dans cette
présentation nous focaliserons sur les emissions totales de gas à effet
de serre par unité de PIB et par personne, ainsi que que les émissions
totales de CO2 par unité de PIB et par personne

La manière la plus direct d'afficher le découplage entre une pression
environnementale et une force économique consiste à tracer deux séries
temporelles indexées (par exemple 1980 = 100) sur le même graphique. A
partir d'un tel graphique, il est immédiatement clair si une force
économique croit ou décroit, si le découplage -absolu ou relatif-
s'opère et quand il commence et s'il continue.

Pour comparer le découplage parmi les pays, le ratio de la valeur du
découplage à la fin et au début d'une période de temps donnée est
définie comme : Ration = \[(EP/DF)\_endofperiod\] /
\[(EP/DF)\_startofperiod\] avec EP = Pression environnementale et DF =
Force motrice

#### Ne pas sommer les PIB par habitant pour obtenir le PIB par habitant total !
#### Convertir PIB réel faire *10^6 

```{r}
#Pour les GES
#Tous les pays de l'OCDE et les trois régions principales (Europe, Amérique du Nord et Pacifique)

#Variables : PIB par habitant / Emission de GES
decoupling_CO2_OCDE <-  OCDE_pays %>% filter(Variable %in% c("PIB réel","Émissions totales de GES (kt d’équivalent CO2)","Population, total")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

#Création d'un index 
CO2_total_OCDE_index <- decoupling_CO2_OCDE %>% filter(Pays%in%unique(decoupling_CO2_OCDE$Pays)) %>% group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

CO2_total_OCDE <- CO2_total_OCDE_index %>% group_by(Année) %>% summarise(Ratio = `GES_tot`/`PIB_hab`) 

CO2_total_OCDE <- CO2_total_OCDE %>% mutate(Ratio_base100 = Ratio / Ratio[which(CO2_total_OCDE$Année == 1990)]*100)


ggplot(CO2_total_OCDE, aes(x = Année, y = Ratio_base100))  + geom_point() + labs(title = "Emissions par unité de PIB et par personne en base 100 (1990) pour le total de l'OCDE", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 

#Tous les pays non membres de l'OCDE 

#Variables : PIB par habitant / Emission de CO2
decoupling_CO2_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("PIB réel","Émissions totales de GES (kt d’équivalent CO2)", "Population, total")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

#On crée un index

CO2_total_non_OCDE_index <- decoupling_CO2_non_OCDE %>% filter(Pays%in%unique(decoupling_CO2_non_OCDE$Pays)) %>% group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

CO2_total_non_OCDE <- CO2_total_non_OCDE_index %>% group_by(Année) %>% summarise(Ratio = `GES_tot`/`PIB_hab`) 

CO2_total_non_OCDE <- CO2_total_non_OCDE %>% mutate(Ratio_base100 = Ratio / Ratio[which(CO2_total_non_OCDE$Année == 1990)]*100)



ggplot(CO2_total_non_OCDE, aes(x = Année, y = Ratio_base100))  + geom_point() + labs(title = "Emissions par unité de PIB et par personne en base 100 (1990) pour le total des pays non membres de l'OCDE", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 


#Fusion des deux graphiques
CO2_fusion <- bind_rows(mutate(CO2_total_OCDE, Group = "OCDE"), mutate(CO2_total_non_OCDE, Group = "Non-OCDE"))

ggplot(CO2_fusion, aes(x = Année, y = Ratio_base100, color = Group)) + geom_point() +  labs(title = "Emissions par unité de PIB et par personne en base 100 (1990)", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 

```

```{r}
#On va faire des graphs en considérant la croissance du PIB et la croissance des émissions
#On s'intéresse aux pays membres de l'OCDE
#On calcule les taux de croissance par an du PIB réel par habitant et des Émissions totales de GES (kt d’équivalent CO2)

#OCDE
decoupling_CO2_OCDE_growth <- CO2_total_OCDE_index %>% mutate(taux_PIB = ((`PIB_hab` - lag( `PIB_hab`)) *100/lag( `PIB_hab`)), taux_CO2 = ((`GES_tot` - lag( `GES_tot`))*100 /lag( `GES_tot`)))

decoupling_CO2_OCDE_growth_convert <- decoupling_CO2_OCDE_growth %>% pivot_longer(cols = c(taux_PIB,taux_CO2), names_to = "Variable", values_to = "Taux") 

ggplot(decoupling_CO2_OCDE_growth_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable, group = Variable)) + geom_point(na.rm = TRUE)  + geom_line(na.rm = TRUE) + labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays membres de l'OCDE", x = "Année", y = "Taux de croissance (%)", color = "Variable") +  theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5))

#Non OCDE
decoupling_CO2_non_OCDE_growth <- CO2_total_non_OCDE_index %>% mutate(taux_PIB = ((`PIB_hab` - lag( `PIB_hab`)) *100/lag( `PIB_hab`)), taux_CO2 = ((`GES_tot` - lag( `GES_tot`))*100 /lag( `GES_tot`)))


decoupling_CO2_non_OCDE_growth_convert <- decoupling_CO2_non_OCDE_growth %>% pivot_longer(cols = c(taux_PIB,taux_CO2), names_to = "Variable", values_to = "Taux") 

ggplot(decoupling_CO2_non_OCDE_growth_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable, group = Variable)) + geom_point(na.rm = TRUE)  + geom_line(na.rm = TRUE) + labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays non membres de l'OCDE", x = "Année", y = "Taux de croissance (%)", color = "Variable") +  theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5))  

reg_CO2_PIB_OCDE=lm('taux_CO2 ~ taux_PIB', data = decoupling_CO2_OCDE_growth)
summary(reg_CO2_PIB_OCDE)
ggplot(reg_CO2_PIB_OCDE, aes(x = taux_PIB,y = taux_CO2)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays membres de l'OCDE", x = "Taux de croissance du PIB/hab (%)", y = "Taux de croissance des émissions de GES (%)")

reg_CO2_PIB_non_OCDE=lm('taux_CO2 ~ taux_PIB', data = decoupling_CO2_non_OCDE_growth)
summary(reg_CO2_PIB_non_OCDE)
ggplot(reg_CO2_PIB_non_OCDE, aes(x = taux_PIB,y = taux_CO2)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm',formula = 'y ~ x', se=FALSE, na.rm = TRUE) +  labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays non membres de l'OCDE", x = "Taux de croissance du PIB/hab (%)", y = "Taux de croissance des émissions de GES (%)") + theme_minimal() 

```

*II- Politiques*

Dans cette deuxième partie, l'objectif est d'étudier les pressions
environnementales sur les ressources exercées par les composantes du
PIb, puis d'analyser les politiques mises en place pour réduire cela.

Il nous paraît interessant dans un premier temps de comparer entre les
pays OCDE et hors OCDE les differentes intensité sur l'eau, la qualité
de l'air, et l'adpatation des ressources renouvelables.

**A- Pression environementales** 
*A.1 : Intensité de l'eau*

Afin d'évaluer l'utilisation durable de l'eau, nous allons examiner
l'intensité de l'eau par habitant et par unité de production. Nos
variables principales utilisés sont : Prélèvements bruts d'eau douce par
habitant, Stress hydrique (total des prélèvements d'eau douce en % des
ressources internes renouvelables),Retraits annuels d'eau douce, total
(% des ressources internes), Retraits annuels d'eau douce, (total
milliards de mètres cubes). Nous les avons choisies car elles permettent
d'avoir un aperçu des impacts et des utilisations intensives sur l'eau,
une ressource qui va venir à manquer. Il va aussi être interessant de se
rendre compte des différents accès à l'eau selon les régions du monde,
car 1 personne sur 3 n'y a pas accès créant un nombre élévé de dèces du
à ce manque important.

```{r}
#des graphiques comparatifs entre pays OCDE et hors OCDE vont être utilisé afin d'illsutrer les différences d'utilisation de l'eau selon les régions du monde et leurs économies. 

#Création d'une table afin de summarize les informations statistiques de ces 4 variables concernant l'eau. 
#cependant je n'arrive pas à completement finaliser et je ne trouve pas des valeurs cohérentes, soit toutes pareilles soit des 0 ...



```

```{r}
tab_var<- c("Prélèvements bruts d'eau douce par habitant",
    "Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables",
    "Retraits annuels d’eau douce, total (% des ressources internes)",
    "Retraits annuels d’eau douce, total (milliards de mètres cubes)")

 

#  On calcule la moyenne et la médiane des variables pour chaques pays membres de l'OCDE
eau_OCDE <- OCDE_pays %>% filter(Variable %in% c("Prélèvements bruts d'eau douce par habitant","Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables","Retraits annuels d’eau douce, total (% des ressources internes)","Retraits annuels d’eau douce, total (milliards de mètres cubes)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`)%>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value))

eau_stat_OCDE <- eau_OCDE %>% group_by(Pays,Variable) %>% summarize(
  Valeur_moyenne = mean(`Value`, na.rm = TRUE), 
  valeur_median = median(`Value`, na.rm = TRUE), 
  valeur_min = min(`Value`, na.rm = TRUE), 
  valeur_max = max(`Value`, na.rm = TRUE), 
  .groups = 'drop')

knitr :: kable(eau_stat_OCDE)


# Initialiser le tableau final

for (x in tab_var) {
  # Prendre le resultat pour la variable courante
  data_min <- eau_stat_OCDE %>% filter (Variable==x) %>% select (Pays, Variable, Valeur_moyenne, valeur_median, valeur_min, valeur_max)
  
  # Complter le tableau final avec le resultat courant (rbind)
  print (data_min)
}

# On a le resultat final
```




Voici un tableau récapitulatif pour ces 4 variables qui permettent d'avoir une vue d'ensemble à l'aide d'outils statistics. Les disparités sont énorment entre tous ces pays, en effet prenons par exemple le Brésil pour le retrait annuel d'eau douce par habitant en pourcentage des resssources internes qui à un maximum de 1,32 contrairement au Japon qui est à plus de 182.La situation Géographique est aussi à prendre en compte, cependant ce n'est pas notre cible ici. Nous voulons simplement expliquer la tendance qui est pour les pays de l'OCDE  restée stable depuis les années 1980 en matière des prelevement totaux d'eau de surface mais en parallele les quantitées pour l'irriguation ont augmentés. Ont peux expliquer cela par l'implantation de nouvelles technologies et la transition d'une activitée à une autre. Nous illustrons cela par 4 graph pour les pays de l'oCDE. 

```{r}
#On analyse les tendances des pays membres de l'OCDE

#On effectue la moyenne par an de tous les pays membres de l'OCDE
eau_tendance_OCDE <- eau_OCDE %>% group_by(Année,Variable) %>% summarise(moyenne_annuelle = mean(`Value`, na.rm =TRUE), .groups = 'drop')

ggplot(eau_tendance_OCDE, aes(x=`Année`, y = moyenne_annuelle)) + geom_jitter() + scale_size_continuous("moyenne_annuelle") +  facet_wrap(~ Variable, scales = "free_y", ncol = 1) + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 

```

Nous pouvons observer par ces 4 tableaux, que pour chacune des variables, la moyenne annuelle était plus elevés en 1990 qu'en 2020. Pour la variable : retraits annuel d'eau douce relié au pourcentage des ressources internes , sa croissance est plutot homogene avec celle qui mesure en milliard de mètre cubes, cela est cohérent. Cependant, la demande d'eau ne cesse d'augmenter avec le secteur agricole le principal consommateur avec 70% de la demande d'eau douce (OCDE), puis la production d'éléctricité.
D'après le scénario de reference des Perspectives à horizon 2050, 40% de la population mondiale vivront dans des bassins soumis à un stress hydrique elevé qui correspond à plus de 40% de demande d'eau dites bleues ( eau douces des aquiferes, cours d'eau et lacs). 
Ces indicateurs ne refletent pas la réalité complexe, la diminution de la moyenne annuelle transcrit le fait que les pays de l'OCDE developpés ont finis leurs croissance exponentielles. Cependant les BRIICS et les autres pays emergents devrait voir leurs consommation augementer fortement pour le secteur manufacturier, la production d'éléctricité et les besoins domestiques. 


*A.2 : Qualité de l'air* L'indice de qualité de l'air sera utilisé pour évaluer les niveaux de pollution atmoshpériques. Cette donnée interessante pourra aussi nous donner des indices sur les secteurs intensifs des pays. Un pays au secteur industriel principale aura tendance à peut-être rejeté plus de CO2 dans l'air qu'un autre.Aujourd'hui, les particules types pm10, pm2.5 sont concentrés dans les millieux surtout urbains et supérieurs aux règles fixés. Cette surexposition entraîne la hausse du nombre de dècés par leurs contenance de produits toxiques qui penetrent dans les poumons. En effet le nombre de décès est passé de près d'un million en 2000 à plus de 3.5 millions d'ici 2050, avec une majorité dans les BRIICS. 

1) émission GES et autres particules 



```{r}
CO2_emission_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Émissions de CO2 (kt)","Population, total","Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)")) %>% select(-COU, -VAR ,- Unit, -PowerCode) %>% pivot_longer(cols = c(1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009,2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017, 2018, 2019, 2020),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

#Création d'un index 

CO2_emission_OCDE_index <- CO2_emission_OCDE %>% filter(Pays%in%unique(decoupling_CO2_OCDE$Pays)) %>% group_by(Année) %>% summarise(Hab_tot = sum(Population, total,na.rm = TRUE), CO2_emi_tot = sum(Émissions de CO2 (kt), na.rm = TRUE), Autre_CO2 = sum(Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2), na.rm = TRUE)) %>% mutate(CO2_hab = CO2_emi_tot/Hab_tot)
```



```{r}
# Sélectionner les variables d'intérêt




selected_variables <- c(
  "Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)","Population totale","Émissions de CO2 (kt)",
  "Émissions de CO2 (tonnes métriques par habitant)")

# Filtrer les données pour les variables sélectionnées et tous les pays
selected_data <- OCDE_pays %>%
  filter(Variable %in% selected_variables)


# Créer le graphique en barres empilées avec facettes
ggplot(selected_data, aes(x 
                          = Année, y = Value, fill = Variable)) +
  geom_bar(stat = "identity") +
  labs(title = "Évolution des variables sélectionnées par année",
       x = "Année",
       y = "Valeur") +
  facet_wrap(~ Variable, scales = "free_y", ncol = 1) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotation des années sur l'axe x

```




2) expositions a la pollution et decès

variable 

```{r}
# Assurez-vous que le nom de la colonne est correct et sans espaces ou caractères spéciaux
lm_model <- lm("Mortalité due à l'exposition aux PM2.5"~ "Exposition moyenne de la population aux PM2.5" , data = OCDE_pays %>% filter(Variable %in% c("Mortalité due à l'exposition aux PM2.5", "Exposition moyenne de la population aux PM2.5")))%>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value))

# Affichez le résumé de la régression
summary(lm_model)
)
```


#Corrélation à faire 
#A voir si j'ai le temps de la faire
*A.3 : Adoption de sources d'énergies renouvelables* Depuis 1990 nous
pouvons observer la tendance de l'adopation d'energie renouvelable et
les pays qui en sont les moteurs.



```{r}

library(dplyr)
library(knitr)

# Sélection des variables d'intérêt
selected_variables <- c("Intensité CO2 induite par la production", 
                        "émissions de CO2 liées à l'énergie, par habitant",
                        "Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)", 
                        "Émissions/éliminations nettes de GES attribuables au changement d'affectation des terres et à la foresterie (Mt d’équivalents CO2)",
                        "Émissions totales de GES (kt d’équivalent CO2)")

# Filtrer les données pour les variables sélectionnées
selected_data <- OCDE_pays %>%
  filter(Variable %in% selected_variables)

# Calcul des valeurs minimales et maximales pour chaque variable, par pays (OCDE)
air_stat_OCDE <- selected_data %>%
  filter(`Pays` == "Membre") %>%
  group_by(Variable) %>%
  summarize(
    valeur_min_OCDE = min(`Value`, na.rm = TRUE),
    valeur_max_OCDE = max(`Value`, na.rm = TRUE),
    .groups = 'drop'
  )

# Affichage du tableau pour les pays de l'OCDE
knitr::kable(air_stat_OCDE, caption = "Tableau des valeurs minimales et maximales sur les variables hydriques d'intérêt pour les pays de l'OCDE")

# Calcul des valeurs minimales et maximales pour chaque variable, par pays (non OCDE)
air_stat_non_OCDE <- selected_data %>%
  filter(`OCDE` == "Non-Membre") %>%
  group_by(Variable) %>%
  summarize(
    valeur_min_non_OCDE = min(`Value`, na.rm = TRUE),
    valeur_max_non_OCDE = max(`Value`, na.rm = TRUE),
    .groups = 'drop'
  )

# Affichage du tableau pour les pays non membres de l'OCDE
knitr::kable(air_stat_non_OCDE, caption = "Tableau des valeurs minimales et maximales sur les variables hydriques d'intérêt pour les pays non membres de l'OCDE")

```


*B- Politiques Environnementales* Après avoir pu observer les pressions
exercés par les composantes de notre activité économique, nous allons
pouvoir nous interesser aux politiques mises en place pour les réguler.

*B.1* tax 
Une taxe environnementale est caractérisée par son action sur
les coûts des activités ou les prix des produits qui ont un effet
négatif sur l'environnement. C'est une internalisation de l'externalité négative.La taxe carbone est la plus utilisé, elle taxe les émissions de dioxyde de carbone, le gaz à effet de serre qui contribue majoritairement à la deterioration du capital naturel. 


```{r}
#graph sur les taxes 

Rand D 
"Développement de technologies liées à l'environnement, % inventions dans le monde"
"Développement de technologies liées à l'environnement, inventions par habitant"


#R&D : graph montrant l'évolution des efforts en R&D correlé ou non avec après les subventions ou aussi la transition vers les nergies renouvelable ?

```


```{r}
library(ggplot2)
library(tidyr)

#pour OCDE
OCDE_pays_Taxes <- OCDE_pays %>%
  filter(Variable == "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_Taxes <- non_OCDE_pays%>%
  filter(Variable == "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_data <- bind_rows(OCDE_pays_Taxes, non_OCDE_pays_Taxes)

ggplot(merged_data, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()
```



#Voici un graph presentant les Recettes provenant des taxes liées à l'énergie pour les pays OCDE et ceux hors OCDE.Nous pouvons observer que le taux des recettes des taxes pour le groupe OCDE est largement supérieur a hors OCDE avec un taux plutot constant autour des 70%. Contrairement les pays hors OCDE ont connu une croissance asymptomatique depuis les années 1990 avec un pic entre 2010 et 2015 à plus de 50%. Les recettes beaucoup plus éléves pour les pays de l'OCDE permettent des mesures plus importantes.
Les taxes representent une mesure efficace à moindre coût, les pays dans l'OCDE souvent plus developpés que la moyenne hors OCDE ont commencés à se doter de cadres d'actions nationaux afin de préserver l'environnement.Ces mesures sont necessaire afin de pénaliser les technologies nocives et encourager le developpement de celles plus durable. L'innovation technologique via l'investissement en R&D est un élement essentiel de la transition vers une économie plus sobre.Cependant, de nombreux problèmes bloquent l'innovation, notamment la compétitivité accrue entre les entreprises. 




```{r}
#OCDE

OCDE_pays_cor <- OCDE_pays %>%
  filter(Variable %in%c("Développement de technologies liées à l'environnement, % inventions dans le monde","Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")) %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")


modele_OCDE <- lm(Value ~ Pays + as.numeric(Année), data = OCDE_pays_corr)

#print le modele
summary(modele_OCDE)
```




```{r}
# Graphique pour l'OCDE avec les valeurs en taux



OCDE_corr_wide_convert <- OCDE_corr_wide %>% pivot_longer(cols = c("Développement de technologies liées à l'environnement, % inventions dans le monde","Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales"), names_to = "Variable", values_to ="Taux" )

  


ggplot(OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable , linetype = Variable)) +
  geom_point(na.rm = TRUE) +
  geom_line(na.rm = TRUE)+
  labs(title = "Taux de développement de technologies liées à l'environnement et de recettes des taxes environnementales - OCDE",
       x = "Année",
       y = "Taux") +
   theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5))
  theme_minimal()
```


```{r}
library(ggplot2)

non_OCDE_corr_wide_convert <- non_OCDE_corr_wide %>% 
  pivot_longer(cols = c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales"), 
               names_to = "Variable", values_to = "Taux")

ggplot(non_OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable)) +
  geom_line(na.rm = TRUE) +
  labs(title = "Taux de développement de technologies liées à l'environnement et de recettes des taxes environnementales - OCDE",
       x = "Année",
       y = "Taux") +
  theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5)) +
  theme_minimal() +
  facet_grid(Variable ~ ., scales = "free_y")

  
```

```{r}
ggplot(non_OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable)) +
  geom_point(na.rm = TRUE)
  geom_line(size = 1, na.rm = TRUE) +
  labs(title = "Taux de développement de technologies liées à l'environnement et de recettes des taxes environnementales - OCDE",
       x = "Année",
       y = "Taux") +  
  theme_minimal()

```


```{r}
library(ggplot2)

non_OCDE_corr_wide_convert <- non_OCDE_corr_wide %>% 
  pivot_longer(cols = c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales"), 
               names_to = "Variable", values_to = "Taux")

ggplot(non_OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable)) +
  geom_smooth(aes(group = Variable), method = "loess", se = FALSE) +
  labs(title = "Taux de développement de technologies liées à l'environnement et de recettes des taxes environnementales - OCDE",
       x = "Année",
       y = "Taux") +
  theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5)) +
  theme_minimal()

```


```{r}
library(ggplot2)

OCDE_corr_wide_convert <-OCDE_corr_wide %>% 
  pivot_longer(cols = c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales"), 
               names_to = "Variable", values_to = "Taux")

ggplot(OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable))  +
  geom_smooth(aes(group = Variable), method = "loess", se = FALSE, na.rm = TRUE) +
  labs(title = "Taux de développement de technologies liées à l'environnement et de recettes des taxes environnementales - OCDE",
       x = "Année",
       y = "Taux") +
  theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5)) +
  theme_minimal() +
  facet_grid(Variable ~ ., scales = "free_y")

```


```{r}
# Données de l'OCDE
OCDE_corr <- OCDE_pays %>%
  filter(Variable %in% c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")) %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE") 

# Graphique pour l'OCDE
ggplot(OCDE_corr, aes(x = Année, y = Value, color = Groupe)) +
  geom_point(size = 3, na.rm = TRUE) +
  geom_smooth(method = 'lm', formula = 'y ~ x', se = FALSE, color = 'red') +
  labs(title = "Pourcentage inventions dans le monde et recettes des taxes environnementales - OCDE",
       x = "Développement de technologies liées à l'environnement (%)",
       y = "Recettes provenant des taxes liées à l'énergie (%)",
       color = "Groupe") +
  theme_minimal()

```


```{r}
library(ggplot2)
library(dplyr)
library(tidyr)

# Données de l'OCDE
# Mettre les variables en colonnes
OCDE_corr_wide <- OCDE_corr %>%
  pivot_wider(names_from = "Variable", values_from = "Value")

non_OCDE_corr_wide <- non_OCDE_corr%>%
  pivot_wider(names_from = "Variable", values_from = "Value")

non_OCDE_corr_wide_convert <- non_OCDE_corr_wide %>% 
  pivot_longer(cols = c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales"), 
               names_to = "Variable", values_to = "Taux")

# Graphique pour l'OCDE
ggplot(non_OCDE_corr_wide_convert, aes(x = Année, y = Taux, color = Variable)) +
  geom_point(size = 3, na.rm = TRUE) +
  labs(title = "Pourcentage inventions dans le monde et recettes des taxes environnementales - OCDE",
       x = "Développement de technologies liées à l'environnement (%)",
       y = "Recettes provenant des taxes liées à l'énergie (%)",
       color = "Groupe") +
  theme_minimal()

```




*B.2* Subventions + prise de décision de protection de l'environnement
#le dispositif de subvention est une aide aux entreprises afin de les aider dans leurs transitions écologique pour aller vers des énergies plus durables. 
# nous allons pouvoir observer l'évolution des subventions via plusieurs variables:

```{r}
library(ggplot2)
library(tidyr)

#pour OCDE
OCDE_pays_subvention <- OCDE_pays %>%
  filter(Variable == "Soutien total aux combustibles fossiles, % recettes totales des taxes" ) %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention <- non_OCDE_pays%>%
  filter(Variable == "Soutien total aux combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_data_subvention <- bind_rows(OCDE_pays_subvention, non_OCDE_pays_subvention)

ggplot(merged_data_subvention, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien total aux combustibles fossiles, % recettes totales des taxes",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()


# Nouveau graph pour les subvention pour les consommateur de combustibles fossiles


#pour OCDE
OCDE_pays_subvention_consommateur <- OCDE_pays %>%
  filter(Variable == "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention_consommateur <- non_OCDE_pays%>%
  filter(Variable == "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_data_subvention_consommateur <- bind_rows(OCDE_pays_subvention_consommateur, non_OCDE_pays_subvention_consommateur)

ggplot(merged_data_subvention_consommateur, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()




#Nouveau graph pour Soutien à l'électricité, % soutien total aux combustibles fossiles


#pour OCDE
OCDE_pays_subvention_éléctricité <- OCDE_pays %>%
  filter(Variable == "Soutien à l'électricité, % soutien total aux combustibles fossiles") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention_éléctricité <- non_OCDE_pays%>%
  filter(Variable == "Soutien à l'électricité, % soutien total aux combustibles fossiles") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_data_subvention_éléctricité <- bind_rows(OCDE_pays_subvention_éléctricité, non_OCDE_pays_subvention_éléctricité)

ggplot(merged_data_subvention_éléctricité, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien à l'électricité, % soutien total aux combustibles fossiles",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()

```

```{r}

#Zones protégées à l'échelle nationale (% du territoire total)
#Zones terrestres et marines protégées (% du territoire total)
#Zones marines protégées (% des eaux du territoire)

#faire un graph ou une table

# puis observations/ conclusion sur ces politiques 



```

*III- Vulnérabilités et strategies adaptives*

*A- Variable démographique* La migrations des populations vers les
espaces urbains s'est réalisé de manière continu depuis
l'industrialisation au 19 ième siècle. Aujurd'hui les espaces ruraux
sont vides mais à cause d'une pression environementales qui devient trop
elevés, et dérangeante ce mouvement peut avoir changer. Nous allons
analyser ces migrations dans un graph afin de nous rendre compte depuis
1990 des ces évolutions. La Worldbank à plus de variable sur les indices
urbains, tandis que l'OCDE est plus tourné vers les migrations, ce qui
va nous permettre d'avoir un grand calibre de donnée.

```{r}
```

*B- vulnérabilité humaine face aux changement climatiques*
L'industrialisation intensives qui a lieu depuis le 19 ieme siècle et la
consommation de masse des 30 glorieuses n'a pas laissé notre planète
indemne. En effet, les catastrophes naturelles se multiplient et nous
sommes totalement vulnérable face à cet nature déchainé.

```{r}


```

```{r}
# Installer les packages si ce n'est pas déjà fait
# install.packages(c("ggplot2", "dplyr"))
# 
# # Charger les bibliothèques
# library(ggplot2)
# library(dplyr)
# 
# # Supposons que votre jeu de données s'appelle non_OCDE_pays
# # Assurez-vous d'avoir correctement chargé vos données
# 
# # Filtrer les données pour la période de 1990 à 2020
# non_OCDE_pays_filtered <- non_OCDE_pays[non_OCDE_pays$année >= 1990 & non_OCDE_pays$année <= 2020, ]
# 
# # Graphique : Évolution des émissions de CO2 (kg par $ PPA de 2011 de PIB) pour les trois premiers pays
# top3_emissions <- non_OCDE_pays_filtered %>%
#   group_by(Pays) %>%
#   arrange(desc(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)
# `)) %>%
#   slice_head(n = 3)
# 
# ggplot(top3_emissions, aes(x = année, y = `Émissions de CO2 (kg par $ PPA de 2011 de PIB)`, color = Pays)) +
#   geom_line() +
#   xlab("Année") +
#   ylab("Émissions de CO2 (kg par $ PPA de 2011 de PIB)") +
#   theme_bw() +
#   ggtitle("Évolution des émissions de CO2 pour les trois premiers pays")
# 
# # Graphique : Distribution des valeurs d'exposition moyenne de la population aux PM2.5
# ggplot(non_OCDE_pays_filtered, aes(x = `Exposition moyenne de la population aux PM2.5`)) +
#   geom_histogram(binwidth = 5, fill = "skyblue", color = "black", alpha = 0.7) +
#   xlab("Exposition moyenne de la population aux PM2.5") +
#   ylab("Fréquence") +
#   theme_bw() +
#   ggtitle("Distribution de l'exposition moyenne aux PM2.5")
# 
# # Table : Statistiques descriptives pour les variables d'intérêt
# summary_table <- non_OCDE_pays_filtered %>%
#   select(`Émissions de CO2 (kg par $ PPA de 2011 de PIB)`,
#          `Émissions de CO2 (kg par $ US de 2010 de PIB)`,
#          `Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`,
#          `Émissions totales de GES (variation depuis 1990, %)`,
#          `Exposition moyenne de la population aux PM2.5`)
# 
# print("Table des statistiques descriptives :")
# print(summary_table)


```




