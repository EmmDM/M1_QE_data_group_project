---
title: "Final Part"
author: "Victoire Truchon-Bartès & Emmanuel de MOREL"
format: html
echo : false
editor: 
  markdown: 
    wrap: 72
---

```{r, echo=FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
# Sélection des librairies
suppressWarnings({suppressMessages(library(here))
suppressMessages(library(dplyr))
library(tidyr)
library(knitr)
library(ggplot2)
library(readr)
library(stringr)
library(readxl)
library(patchwork)})
```

```{r}
#On lit les bases de données OCDE_pays et non_OCDE_pays
donnees_partage <- readRDS("donnees_partage.RDS")
OCDE_pays <- donnees_partage$OCDE_pays
non_OCDE_pays <- donnees_partage$non_OCDE_pays
```

```{r}
#Pour les GES
#Tous les pays de l'OCDE et les trois régions principales (Europe, Amérique du Nord et Pacifique)
#Variables : PIB par habitant / Emission de GES
decoupling_CO2_OCDE <-  OCDE_pays %>% filter(Variable %in% c("PIB réel","Émissions totales de GES (kt d’équivalent CO2)","Population, total")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

#Création d'un index 
CO2_total_OCDE_index <- decoupling_CO2_OCDE %>% filter(Pays%in%unique(decoupling_CO2_OCDE$Pays)) %>% group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

CO2_total_OCDE <- CO2_total_OCDE_index %>% group_by(Année) %>% summarise(Ratio = `GES_tot`/`PIB_hab`)
CO2_total_OCDE <- CO2_total_OCDE %>% mutate(Ratio_base100 = Ratio / Ratio[which(CO2_total_OCDE$Année == 1990)]*100)


#Tous les pays NON membres de l'OCDE 
#Variables : PIB par habitant / Emission de GES
decoupling_CO2_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("PIB réel","Émissions totales de GES (kt d’équivalent CO2)", "Population, total")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

#On crée un indice
CO2_total_non_OCDE_index <- decoupling_CO2_non_OCDE %>% filter(Pays%in%unique(decoupling_CO2_non_OCDE$Pays)) %>% group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

CO2_total_non_OCDE <- CO2_total_non_OCDE_index %>% group_by(Année) %>% summarise(Ratio = `GES_tot`/`PIB_hab`) 

CO2_total_non_OCDE <- CO2_total_non_OCDE %>% mutate(Ratio_base100 = Ratio / Ratio[which(CO2_total_non_OCDE$Année == 1990)]*100)

```

# I. Constat sur la transition écologique

```{r}
#On va faire des graphs en considérant la croissance du PIB et la croissance des émissions
#On s'intéresse aux pays membres de l'OCDE
#On calcule les taux de croissance par an du PIB réel par habitant et des Émissions totales de GES (kt d’équivalent CO2)

#OCDE
decoupling_CO2_OCDE_growth <- CO2_total_OCDE_index %>% mutate(taux_PIB = ((`PIB_hab` - lag( `PIB_hab`)) *100/lag( `PIB_hab`)), taux_CO2 = ((`GES_tot` - lag( `GES_tot`))*100 /lag( `GES_tot`)))

decoupling_CO2_OCDE_growth_convert <- decoupling_CO2_OCDE_growth %>% pivot_longer(cols = c(taux_PIB,taux_CO2), names_to = "Variable", values_to = "Taux") 

ggplot(decoupling_CO2_OCDE_growth_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable, group = Variable)) + geom_point(na.rm = TRUE)  + geom_line(na.rm = TRUE) + labs(title = "Taux de croissance du PIB par habitant  \n et taux de croissance des émissions de CO2 des pays membres de l'OCDE", x = "Année", y = "Taux de croissance (%)", color = "Variable") +  theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5))

#Non OCDE
decoupling_CO2_non_OCDE_growth <- CO2_total_non_OCDE_index %>% mutate(taux_PIB = ((`PIB_hab` - lag( `PIB_hab`)) *100/lag( `PIB_hab`)), taux_CO2 = ((`GES_tot` - lag( `GES_tot`))*100 /lag( `GES_tot`)))

decoupling_CO2_non_OCDE_growth_convert <- decoupling_CO2_non_OCDE_growth %>% pivot_longer(cols = c(taux_PIB,taux_CO2), names_to = "Variable", values_to = "Taux")

# Représentation des graphiques considérant la croissance du PIB et la croissance des émissions
#On s'intéresse aux pays non membres de l'OCDE
ggplot(decoupling_CO2_non_OCDE_growth_convert, aes(x = Année, y = Taux, color = Variable, linetype = Variable, group = Variable)) + geom_point(na.rm = TRUE)  + geom_line(na.rm = TRUE) + labs(title = "Taux de croissance du PIB par habitant \n et taux de croissance des émissions de CO2 des pays non membres de l'OCDE", x = "Année", y = "Taux de croissance (%)", color = "Variable") +  theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5))  
```

```{r}
reg_CO2_PIB_OCDE=lm('taux_CO2 ~ taux_PIB', data = decoupling_CO2_OCDE_growth)
summary(reg_CO2_PIB_OCDE)
ggplot(reg_CO2_PIB_OCDE, aes(x = taux_PIB,y = taux_CO2)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays membres de l'OCDE", x = "Taux de croissance du PIB/hab (%)", y = "Taux de croissance des émissions de GES (%)")

reg_CO2_PIB_non_OCDE=lm('taux_CO2 ~ taux_PIB', data = decoupling_CO2_non_OCDE_growth)
summary(reg_CO2_PIB_non_OCDE)
ggplot(reg_CO2_PIB_non_OCDE, aes(x = taux_PIB,y = taux_CO2)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm',formula = 'y ~ x', se=FALSE, na.rm = TRUE) +  labs(title = "Taux de croissance du PIB par habitant et taux de croissance des émissions de CO2 des pays non membres de l'OCDE", x = "Taux de croissance du PIB/hab (%)", y = "Taux de croissance des émissions de GES (%)") + theme_minimal() 

```

## *A) Découplage*

Le découplage se produit lorsque le taux de croissance d'une pression
environnementale est inférieur à celui de sa force motrice économique
(par exemple le PIB) sur une période donnée. Le découplage peut être
absolu ou relatif. On parle de découplage absolu lorsque la variable
pertinente pour l'environnement est stable ou décroissante alors que la
force motrice économique augmente. Le découplage est dit relatif lorsque
le taux de croissance de la variable pertinente pour l'environnement est
positif, mais inférieur au taux de croissance de la variable économique.
Il existe un nombre varié d'indicateur de découplage, dans cette
présentation nous focaliserons sur les emissions totales de gaz à effet
de serre (GES) par unité de PIB et par personne. La manière la plus
directe d'afficher le découplage entre une pression environnementale et
une force économique consiste à tracer deux séries temporelles indexées
(par exemple 1980 = 100) sur le même graphique. A partir d'un tel
graphique, il est immédiatement clair si une force économique croit ou
décroit, si le découplage -absolu ou relatif- s'opère et quand il
commence et s'il continue.

Pour comparer le découplage parmi les pays, le ratio de la valeur du
découplage à la fin et au début d'une période de temps donnée est
définie comme :
$$ Ratio = {(PE/FM)_{findepériode} / (PE/FM)_{débutdepériode}} $$

avec : PE = Pression environnementale et FM = Force motrice

```{r}
#Representation graphique de l'indice de découplage entre les émissions de GES et le PIB/hab pour l'ensemble des pays membres de l'OCDE
ggplot(CO2_total_OCDE, aes(x = Année, y = Ratio_base100))  + geom_point() + labs(title = "Emissions par unité de PIB et par personne en base 100 (1990) pour le total de l'OCDE", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 

#Representation graphique de l'indice de découplage entre les émissions de GES et le PIB/hab pour l'ensemble des pays NON membres de l'OCDE
ggplot(CO2_total_non_OCDE, aes(x = Année, y = Ratio_base100))  + geom_point() + labs(title = "Emissions par unité de PIB et par personne en base 100 (1990) pour le total des pays non membres de l'OCDE", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 


#Fusion des deux graphiques
CO2_fusion <- bind_rows(mutate(CO2_total_OCDE, Group = "OCDE"), mutate(CO2_total_non_OCDE, Group = "Non-OCDE"))

ggplot(CO2_fusion, aes(x = Année, y = Ratio_base100, color = Group)) + geom_point() +  labs(title = "Emissions par unité de PIB et par personne en base 100 (1990)", x = "Année", y = "Ratio (Base 100 en 1990)") + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 

```

```{r}
#Ici le but est de réaliser un diagramme en nuage de point avec en abscisse le taux de croissance du PIB en pourcentage en 2020 depuis 1990 et en ordonnées le taux de croisssance des émissions de GES en pourcentage en 2020 depuis 1990. Cela nous permettra de distinguer les pays qui ont on effectué un découplage et de de quel type de découplage il s'agit


#OCDE
decoupling_final <- decoupling_CO2_OCDE %>% group_by(Année, Pays) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE), .groups = 'drop') %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

decoupling_final_convert <- decoupling_final %>% filter(Pays%in%unique(decoupling_final$Pays)) %>% group_by(Pays) %>% summarise(taux_GES_90_20 = (GES_tot[Année == 2020] - GES_tot[Année == 1990])*100/ GES_tot[Année == 1990], taux_PIB_90_20 = (PIB_hab[Année == 2020] - PIB_hab[Année == 1990])*100/ PIB_hab[Année == 1990],  .groups = 'drop')

decoupling_final_convert  <- decoupling_final_convert  %>% filter(!is.infinite(taux_PIB_90_20) & !is.infinite(taux_GES_90_20))
  
graph_decoupling <- ggplot(decoupling_final_convert, aes(x = taux_PIB_90_20,y = taux_GES_90_20)) + geom_point( size=1, na.rm = TRUE)  +  labs(title = "Découplage au sein de l'OCDE", x = "Taux de croissance du PIB/hab en 2020 par rapport à 1990 (%)", y = "Taux de croissance des émissions de GES en 2020 par rapport à 1990 (%)") + theme_minimal() 

graph_decoupling + geom_abline(intercept = 0, slope = 1, color = "black") + geom_abline(intercept = 0, slope = 0, color = "black") + geom_abline(intercept = 0, slope = 0, color = "black") + geom_vline(xintercept = 0, color = "black")

#Non - OCDE
decoupling_final_non_OCDE <- decoupling_CO2_non_OCDE %>% group_by(Année, Pays) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), GES_tot = sum(`Émissions totales de GES (kt d’équivalent CO2)`, na.rm = TRUE),  .groups = 'drop') %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`)

decoupling_final_convert_non_OCDE <- decoupling_final_non_OCDE %>% filter(Pays%in%unique(decoupling_final_non_OCDE$Pays)) %>% group_by(Pays) %>% summarise(taux_GES_90_20 = (GES_tot[Année == 2020] - GES_tot[Année == 1990])*100/ GES_tot[Année == 1990], taux_PIB_90_20 = (PIB_hab[Année == 2020] - PIB_hab[Année == 1990])*100/ PIB_hab[Année == 1990],.groups = 'drop')

decoupling_final_convert_non_OCDE  <- decoupling_final_convert_non_OCDE  %>% filter(!is.infinite(taux_PIB_90_20) & !is.infinite(taux_GES_90_20))

x_limits <- c(-70,1000)
y_limits <- c(-75,1000)
graph_decoupling_non_OCDE <- ggplot(decoupling_final_convert_non_OCDE, aes(x = taux_PIB_90_20,y = taux_GES_90_20)) + geom_point( size=1, na.rm = TRUE)  +  labs(title = "Découplage des pays non membres de l'OCDE", x = "Taux de croissance du PIB/hab en 2020 par rapport à 1990 (%)", y = "Taux de croissance des émissions de GES en 2020 par rapport à 1990 (%)") + theme_minimal() + coord_cartesian(xlim = x_limits, ylim = y_limits) 

graph_decoupling_non_OCDE + geom_abline(intercept = 0, slope = 1, color = "black") + geom_abline(intercept = 0, slope = 0, color = "black") + geom_abline(intercept = 0, slope = 0, color = "black") + geom_vline(xintercept = 0, color = "black")


```

Les pays dont le point se trouve à gauche de l'axe des ordonnées ou au
dessus de la droite d'équation y = x sont des pays où le découplage n'a
pas eu lieu. Les pays dont le point se trouve en dessous de la droite
d'équation y = x mais au dessus de l'axe des abscisse, sont des pays
ayant effectués un découplage relatif, c'est à dire dont les émissions
de GES ont cru plus lentement que le PIB. Les pays dont le point est à
droite de l'axe des ordonnées et en dessous de l'axe des abscisse sont
des pays ayant effectuées un découplage absolue, c'est à dire les pays
dont les émissions de GES ont diminué tandis que le PIB a cru

```{r}
decoupling_table_OCDE <- decoupling_final_convert %>% mutate(decoupling_type = case_when(taux_GES_90_20 > taux_PIB_90_20 ~ "No decoupling", taux_GES_90_20 <= taux_PIB_90_20 & taux_GES_90_20 >= 0 ~"Relative decoupling", taux_GES_90_20 < 0 & taux_PIB_90_20 >= 0 ~ "Absolute decoupling", TRUE ~ "Other"))

decoupling_summary_OCDE <- decoupling_table_OCDE %>% group_by(decoupling_type) %>% summarise(percentage = n()/nrow(decoupling_table_OCDE)*100)

decoupling_table_non_OCDE <- decoupling_final_convert_non_OCDE %>% mutate(decoupling_type = case_when(taux_GES_90_20 > taux_PIB_90_20 ~ "No decoupling", taux_GES_90_20 <= taux_PIB_90_20 & taux_GES_90_20 >= 0 ~"Relative decoupling", taux_GES_90_20 < 0 & taux_PIB_90_20 >= 0 ~ "Absolute decoupling", TRUE ~ "Other"))

decoupling_summary_non_OCDE <- decoupling_table_non_OCDE %>% group_by(decoupling_type) %>% summarise(percentage = n()/nrow(decoupling_table_non_OCDE)*100)


knitr :: kable(decoupling_summary_OCDE, caption = "Part des pays membres de l'OCDE d'après le découplage effectué")

knitr :: kable(decoupling_summary_non_OCDE, caption = "Part des pays non membres de l'OCDE d'après le découplage effectué")
```

I.2 Nous analyserons aussi les tendances en matière d'intensité carbone
et d'efficacité énergétique.

A. Courbe environnementale de Kuznets "Selon l'économiste Éloi Laurent,
spécialiste de la croissance, la source de l'idée de découplage repose
sur la courbe environnementale de Kuznets, théorie construite dans les
années 1990 selon laquelle les dommages environnementaux augmentent dans
les premières phases du développement d'une société, puis reculent alors
que la croissance économique se poursuit" (Wikipedia, découplage
(écologie))

La courbe de Kuznets, dont la forme est U inversé, représente
initiallement l'inégalité économique dans un pays en fonction de son
niveau de développement. C'est selon Grossman et Krueger (1994), que
cette forme de courbe peut être observée dans le domaine de
l'environnement.Le modèle de courbe environnementale de Kuznets (EKC)
postule une relation déterministe entre développement économique et
qualité de l'environnement. Dans la première étape de
l'industrialisation, la pollution augmente rapidement car les individus
sont principalement interessées par leur travail et leur revenus que par
la qualité de l'air et de l'eau. A ce stade, la société est trop pauvre
pour réduire ses émissions, de fait la réglementations environnementales
est trop failbe. Le retournement s'effectue à mesure que les revenus
augmentent. Dès lors, les principaux secteurs industriels deviennent
plus propres, les individus valorisent l'environnement et les
institutions de régulation deviennent plus efficaces. Le long de la
courbe, la pollution se stabilise dans la tranche des revenus moyens,
puis retombe au niveau pré-industriel dans les sociétés développées.

```{r}
#CKE 1990
#En abscisse le PIB par tête et en ordonnées le GES par tête
#PIB_hab, GES_hab
#Fusion OCDE, non_OCDE, group
#ggplot
CKE_1990 <- bind_rows(mutate(decoupling_final, Group = "OCDE"),mutate(decoupling_final_non_OCDE, Group = "Non-OCDE"))
CKE_1990 <- CKE_1990 %>% group_by(Année) %>% mutate(GES_hab = `GES_tot` / `Hab_tot`)
CKE_1990 <- CKE_1990 %>% filter(Pays%in%unique(CKE_1990$Pays)) %>% group_by(Pays, Group) %>% summarise(PIB_hab = PIB_hab[Année == 1990], GES_hab = GES_hab[Année == 1990], .groups = 'drop')

ggplot(CKE_1990, aes(x = PIB_hab, y = GES_hab, color = Group)) + geom_point(na.rm = TRUE) + geom_smooth(method = 'lm', formula = y ~ poly(x, 2), se = FALSE, color = 'darkorange') + labs(title = "Courbe de Kuznets environnementale en 1990", x = "PIB par habitant", y = "Emmission de GES")


#CKE 2020
CKE_2020 <- bind_rows(mutate(decoupling_final, Group = "OCDE"),mutate(decoupling_final_non_OCDE, Group = "Non-OCDE"))
CKE_2020 <- CKE_2020 %>% group_by(Année) %>% mutate(GES_hab = `GES_tot` / `Hab_tot`)
CKE_2020 <- CKE_2020 %>% filter(Pays%in%unique(CKE_2020$Pays)) %>% group_by(Pays, Group) %>% summarise(PIB_hab = PIB_hab[Année == 2020], GES_hab = GES_hab[Année == 2020], .groups = 'drop')

ggplot(CKE_2020, aes(x = PIB_hab, y = GES_hab, color = Group)) + geom_point(na.rm = TRUE) + geom_smooth(method = 'lm', formula = y ~ poly(x, 2), se = FALSE, color = 'darkorange') + labs(title = "Courbe de Kuznets environnementale en 2020", x = "PIB par habitant", y = "Emmission de GES")



```

En utilisant les données des pays pour les emissions de GES et les PIB
par habitant, nous constatons qu'il n'y a pas de courbe en U inversée,
ni en 1990, ni en 2020. En effet, à mesure que le PIB est élevé, les
émissions de GES devraient théoriquement diminuées dans les pays
développées, or ce n'est pas ce qui est observées empiriquement, bien
qu'en 2020 il semble y avoir un seuil aux émissions de GES qui n'étaient
pas constaté en 1990. Toutefois, l'année 2020 est aussi une année
particulière en raison de la pandémie de COVID-19 qui a drastiquement
diminué les émissions de CO2, comme le montre l'un des graphiques
précédent.

I.3 Identité de Kaya

"L'identité de Kaya, relie les émissions anthropique de dioxyde de
carbone à des paramètre d'ordre démographique, économique et
énergétique. \[...\] Selon Kaya, le niveau total d'émission peut
s'exprimer comme le produit de quatres facteurs : la population, le PIB
par habitant, l'intensité énergétique et le contenu en CO2 de l'énergie
consommée. Cette identité se décompose par : CO2 = POP \* (PIB/POP) \*
(E/PIB) \* (CO2/E) Avec : CO2 : Emission de CO2 POP : la population PIB
: Produit interieur brut E : consommation d'énergie PIB/POP : Produit
interieur brut par habitant E/PIB : Intensité énergétique du PIB CO2/E :
Intensité carbone de l'énergie

```{r}
#Identité de Kaya pour l'ensemble des pays membres de l'OCDE
Kaya_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Émissions de CO2 (kt)","Population, total","PIB réel","Approvisionnements totaux en énergie")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

Kaya_OCDE <- Kaya_OCDE %>%  group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), CO2_tot = sum(`Émissions de CO2 (kt)`, na.rm = TRUE), E_tot = sum(`Approvisionnements totaux en énergie`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`, IEP_tot = `E_tot`/`PIB_tot`, ICE_tot = `CO2_tot`/`E_tot`)

Kaya_OCDE_growth <- Kaya_OCDE %>% mutate(taux_PIB_hab = ((`PIB_hab` - lag( `PIB_hab`))*100/lag( `PIB_hab`)),taux_CO2 = ((`CO2_tot` - lag( `CO2_tot`))*100 /lag( `CO2_tot`)), taux_POP = ((`Hab_tot` - lag(`Hab_tot`))*100 / `Hab_tot`), taux_IEP = ((`IEP_tot` - lag( `IEP_tot`))*100 /lag( `IEP_tot`)), taux_ICE = ((`ICE_tot` - lag( `ICE_tot`))*100 /lag( `ICE_tot`)))

ggplot(Kaya_OCDE_growth, aes(x = Année)) + geom_bar(aes(y = taux_PIB_hab, fill = "Taux PIB par habitant"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_POP, fill = "Taux population"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_IEP, fill = "Taux de l'intensité énergétique du PIB"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_ICE, fill = "Taux de l'intensité carbone de l'énergie"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_point(aes(y = taux_CO2), color = 'black', size = 2, na.rm = TRUE) + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) +  labs(title = "Identité de Kaya des pays membres de l'OCDE", x = "Année", y = "Taux (%)") + geom_abline(intercept = 0, slope = 0, color = "black") 



#Identité de Kaya pour l'ensemble des pays non membres de l'OCDE
Kaya_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("Émissions de CO2 (kt)","Population, total","PIB réel","Approvisionnements totaux en énergie")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

Kaya_non_OCDE <- Kaya_non_OCDE %>%  group_by(Année) %>% summarise(PIB_tot = sum(`PIB réel`, na.rm = TRUE)*1000000, Hab_tot = sum(`Population, total`,na.rm = TRUE), CO2_tot = sum(`Émissions de CO2 (kt)`, na.rm = TRUE), E_tot = sum(`Approvisionnements totaux en énergie`, na.rm = TRUE)) %>% mutate(PIB_hab = `PIB_tot`/`Hab_tot`, IEP_tot = `E_tot`/`PIB_tot`, ICE_tot = `CO2_tot`/`E_tot`)

Kaya_non_OCDE_growth <- Kaya_non_OCDE %>% mutate(taux_PIB_hab = ((`PIB_hab` - lag( `PIB_hab`))*100/lag( `PIB_hab`)),taux_CO2 = ((`CO2_tot` - lag( `CO2_tot`))*100 /lag( `CO2_tot`)), taux_POP = ((`Hab_tot` - lag(`Hab_tot`))*100 / `Hab_tot`), taux_IEP = ((`IEP_tot` - lag( `IEP_tot`))*100 /lag( `IEP_tot`)), taux_ICE = ((`ICE_tot` - lag( `ICE_tot`))*100 /lag( `ICE_tot`)))

ggplot(Kaya_non_OCDE_growth, aes(x = Année)) + geom_bar(aes(y = taux_PIB_hab, fill = "Taux PIB par habitant"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_POP, fill = "Taux population"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_IEP, fill = "Taux de l'intensité énergétique du PIB"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_bar(aes(y = taux_ICE, fill = "Taux de l'intensité carbone de l'énergie"), stat ="identity", position = "dodge", na.rm = TRUE) + geom_point(aes(y = taux_CO2), color = 'black', size = 2, na.rm = TRUE) + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) +  labs(title = "Identité de Kaya des pays non membres de l'OCDE", x = "Année", y = "Taux (%)") + geom_abline(intercept = 0, slope = 0, color = "black") 


```

```{r}
#Kaya Table
Kaya_table_OCDE <- Kaya_OCDE_growth %>% select(Année,taux_PIB_hab,taux_CO2,taux_POP,taux_ICE,taux_IEP)

Kaya_OCDE_growth <- Kaya_OCDE %>% mutate(taux_PIB_hab = ((`PIB_hab` - lag( `PIB_hab`))*100/lag( `PIB_hab`)),taux_CO2 = ((`CO2_tot` - lag( `CO2_tot`))*100 /lag( `CO2_tot`)), taux_POP = ((`Hab_tot` - lag(`Hab_tot`))*100 / `Hab_tot`), taux_IEP = ((`IEP_tot` - lag( `IEP_tot`))*100 /lag( `IEP_tot`)), taux_ICE = ((`ICE_tot` - lag( `ICE_tot`))*100 /lag( `ICE_tot`)))
```

# II- Equilibre écologique en péril : analyse des pressions environnementales et des politiques en action

Dans cette deuxième partie, l'objectif est d'étudier les pressions
environnementales sur les ressources exercées par les composantes du
PIB, puis d'analyser les politiques mises en place pour réduire cela.

## **A- Pression environnementales**

Nous envisageons de comparer les intensités sur l'eau et la qualité de
l'air entre les pays de l'OCDE et hors OCDE. Pour évaluer l'utilisation
durable de l'eau, nous examinerons l'intensité de l'eau par habitant et
par unité de production. Cette évaluation sera basée sur des variables
telles que les prélèvements bruts d'eau douce par habitant, le stress
hydrique, les retraits annuels d'eau douce en pourcentage des ressources
internes renouvelables, ainsi que le volume total. Ces indicateurs
offrent un aperçu des impacts et des utilisations intensives de l'eau,
une ressource cruciale confrontée à des défis mondiaux.

```{r}




eau_OCDE <- OCDE_pays %>% filter(Variable %in% c("Prélèvements bruts d'eau douce par habitant","Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables","Retraits annuels d’eau douce, total (% des ressources internes)","Retraits annuels d’eau douce, total (milliards de mètres cubes)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`)%>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value))

eau_stat_OCDE <- eau_OCDE %>% group_by(Pays,Variable) %>% 
  summarize(
  Valeur_moyenne = mean(`Value`, na.rm = TRUE), 
  valeur_median = median(`Value`, na.rm = TRUE), 
  valeur_min = min(`Value`, na.rm = TRUE), 
  valeur_max = max(`Value`, na.rm = TRUE), 
  .groups = 'drop')


eau_stat_OCDE_head <- head(eau_stat_OCDE, 10)
tableau_OCDE <- knitr::kable(eau_stat_OCDE_head)



#Non OCDE

tab_var_non_OCDE<- c("Prélèvements bruts d'eau douce par habitant",
    "Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables",
    "Retraits annuels d’eau douce, total (% des ressources internes)",
    "Retraits annuels d’eau douce, total (milliards de mètres cubes)")

 
eau_non_OCDE <- non_OCDE_pays %>% filter(Variable %in% c("Prélèvements bruts d'eau douce par habitant","Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables","Retraits annuels d’eau douce, total (% des ressources internes)","Retraits annuels d’eau douce, total (milliards de mètres cubes)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`)%>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value))


eau_stat_non_OCDE <- eau_non_OCDE %>%
  group_by(Pays, Variable) %>%
  summarize(
    Valeur_moyenne = mean(`Value`, na.rm = TRUE),
    valeur_median = median(`Value`, na.rm = TRUE),
    valeur_min = min(`Value`, na.rm = TRUE),
    valeur_max = max(`Value`, na.rm = TRUE),
    .groups = 'drop'
  ) 

eau_stat_non_OCDE_head <- head(eau_stat_non_OCDE, 10)
tableau_non_OCDE <- knitr::kable(eau_stat_non_OCDE_head)

cat(" Tableau OCDE\n")
print(tableau_OCDE)

cat(" Tableau Non OCDE\n")
print(tableau_non_OCDE)


```

Voici un tableau synthétique des quatre variables, offrant une vision
globale à l'aide d'outils statistiques. Les disparités entre les pays
sont significatives. Par exemple, l'Allemagne a un retrait annuel d'eau
douce par habitant en pourcentage des ressources internes maximales
d'environ 46 %, tandis que l'Australie ne dépasse pas les 4,5%. La
situation géographique, avec une surface océanique plus vaste au sud,
ainsi que les variations des précipitations et du rayonnement solaire,
contribuent à ces inégalités. Certains pays exercent ainsi une pression
plus intense sur leurs ressources en eau.

```{r}
#On analyse les tendances des pays membres de l'OCDE
eau_tendance_OCDE <- eau_OCDE %>% group_by(Année,Variable) %>% summarise(moyenne_annuelle = mean(`Value`, na.rm =TRUE), .groups = 'drop')

ggplot(eau_tendance_OCDE, aes(x=`Année`, y = moyenne_annuelle)) + geom_jitter() + scale_size_continuous("moyenne annuelle") +  facet_wrap(~ Variable, scales = "free_y", ncol = 1) + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 


#On analyse les tendances des pays non membres de l'OCDE
eau_tendance_non_OCDE <- eau_non_OCDE %>% group_by(Année,Variable) %>% summarise(moyenne_annuelle = mean(`Value`, na.rm =TRUE), .groups = 'drop')

ggplot(eau_tendance_non_OCDE, aes(x=`Année`, y = moyenne_annuelle)) + geom_jitter(na.rm = TRUE) + scale_size_continuous("moyenne annuelle") +  facet_wrap(~ Variable, scales = "free_y", ncol = 1) + theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) 


```

À travers ces quatre tableaux, on observe que, pour chacune des
variables, la moyenne annuelle était plus élevée en 1990 qu'en 2020. En
ce qui concerne la variable des retraits annuels d'eau douce en
pourcentage des ressources internes, sa croissance est plutôt homogène
avec celle mesurée en milliards de mètres cubes, ce qui est cohérent.
Cependant, la demande en eau ne cesse d'augmenter, en particulier dans
le secteur agricole, principal consommateur avec 70 % de la demande
d'eau douce (OCDE), suivi de la production d'électricité.

Selon le scénario de référence des Perspectives à l'horizon 2050, 40 %
de la population mondiale vivra dans des bassins soumis à un stress
hydrique élevé, correspondant à plus de 40 % de demande en eau dite
"bleue" (eau douce des aquifères, cours d'eau et lacs). Ces indicateurs
ne reflètent pas la réalité complexe. La diminution de la moyenne
annuelle traduit le fait que les pays de l'OCDE, ayant achevé leur
croissance exponentielle, ont souvent recours à la délocalisation.

Cependant, les BRIICS et les autres pays émergents devraient voir leur
consommation augmenter considérablement, notamment pour le secteur
manufacturier, la production d'électricité et les besoins domestiques.
Cet écart de croissance est perceptible dans le premier tableau,
montrant une décroissance des prélèvements bruts d'eau douce par
habitant en dessous de 400, contrairement aux pays hors OCDE, où les
prélèvements augmentent depuis 2006. Ainsi, la pression exercée sur les
ressources en eau n'a pas fini d'augmenter, surtout selon les régions du
monde.

En parallèle, la polluton atmosphérique, évaluée par l'indice de qualité
de l'air présente des risques accrus dans les zones urbaines notamme,t
en raison des émissions de CO2et d'autrezs gaz à effet de serre (HFC,
PFC, SF6). Cette surexposition contribue à une augmentation du nombre de
décès en raison de la présence de produits toxiques dans l'air qui
pénètrent les poumons. Le nombre de décès a augmenté, passant d'environ
un million en 2000 à plus de 3,5 millions d'ici 2050, avec une majorité
de pertes prévues dans les pays BRIICS.

```{r}
CO2_emission_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Émissions de CO2 (kt)","Population, total","Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)")) %>% select(-COU, -VAR ,- Unit, -PowerCode) %>%pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 
  

#Création d'un index CO2
CO2_emission_OCDE_index <- CO2_emission_OCDE %>% filter(Pays%in%unique(CO2_emission_OCDE$Pays)) %>% group_by(Année) %>%
summarise(CO2_emi_tot = sum(`Émissions de CO2 (kt)`, na.rm = TRUE), Hab_tot = sum(`Population, total`,na.rm = TRUE), Autre_CO2 = sum(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(CO2_hab = `CO2_emi_tot`/`Hab_tot`)



CO2_emission_habitant_OCDE <- CO2_emission_OCDE_index %>% group_by(Année) %>%summarise(Ratio = `CO2_emi_tot`/`Hab_tot` )
CO2_emission_habitant_OCDE <- CO2_emission_habitant_OCDE  %>% mutate(Ratio_base100 = Ratio / Ratio[which(CO2_emission_habitant_OCDE$Année == 1990)]*100)
  

#Création index GEs
Ges_emission_OCDE_index <- CO2_emission_OCDE %>% filter(Pays%in%unique(CO2_emission_OCDE$Pays)) %>% group_by(Année) %>%
summarise(Ges_emi_tot = sum(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`, na.rm = TRUE), Hab_tot = sum(`Population, total`,na.rm = TRUE), Autre_CO2 = sum(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(Ges_hab = `Ges_emi_tot`/`Hab_tot`)
         

Ges_emission_habitant_OCDE <-Ges_emission_OCDE_index  %>% group_by(Année) %>%summarise(Ratio = `Ges_emi_tot`/`Hab_tot` )
Ges_emission_habitant_OCDE <- Ges_emission_habitant_OCDE  %>% mutate(Ratio_base100 = Ratio / Ratio[which(Ges_emission_habitant_OCDE$Année == 1990)]*100)
  

# Fusion des deux bases de données
merged_Ges_CO2_OCDE <- merge(CO2_emission_habitant_OCDE, Ges_emission_habitant_OCDE, by = "Année", suffixes = c("_Ratio", "_Autres"))

ggplot(merged_Ges_CO2_OCDE, aes(x = Année)) +
  geom_point(aes(y = Ratio_base100_Ratio, color = "CO2 émission par habitant")) +
  geom_point(aes(y = Ratio_base100_Autres, color = "GES émission par habitant")) +
  labs(
    title = "Emissions CO2 et autres GES par personne en base 100 (1990) \n pour le total des pays membres de l'OCDE",
    x = "Année",
    y = "Ratio (Base 100 en 1990)"
  ) +
  theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5)) +
  scale_color_manual(
    values = c("CO2 émission par habitant" = "lightseagreen", "GES émission par habitant" = "#FF6666"),
    labels = c("CO2 émission par habitant", "GES émission par habitant")
  ) +
  guides(color = guide_legend(title = NULL))




#Non OCDE
CO2_emission_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("Émissions de CO2 (kt)","Population, total","Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)")) %>% select(-COU, -VAR ,- Unit, -PowerCode) %>%pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 
  

#Création d'un index autres GES
Ges_emission_non_OCDE_index <- CO2_emission_non_OCDE %>% filter(Pays%in%unique(CO2_emission_non_OCDE$Pays)) %>% group_by(Année) %>%
summarise(Ges_emi_tot = sum(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`, na.rm = TRUE), Hab_tot = sum(`Population, total`,na.rm = TRUE), Autre_CO2 = sum(`Autres émissions de gaz à effet de serre, HFC, PFC et SF6 (milliers de tonnes métriques d’équivalent CO2)`, na.rm = TRUE)) %>% mutate(Ges_hab = `Ges_emi_tot`/`Hab_tot`)
         

Ges_emission_habitant_non_OCDE <-Ges_emission_non_OCDE_index  %>% group_by(Année) %>%summarise(Ratio = `Ges_emi_tot`/`Hab_tot` )
Ges_emission_habitant_non_OCDE <- Ges_emission_habitant_non_OCDE  %>% mutate(Ratio_base100 = Ratio / Ratio[which(Ges_emission_habitant_non_OCDE$Année == 1990)]*100)
  

ggplot(Ges_emission_habitant_non_OCDE, aes(x = Année, y = Ratio_base100)) + geom_point()+
  labs( title = "Emissions GES ( HFC, PFC et SF6 ) par personne en base 100 (1990)\n  pour le total des pays Non membres de l'OCDE",
    x = "Année",
    y = "Ratio (Base 100 en 1990)") +
  theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5))

```

Les émissions de CO2 ont largement dépassé celles des autres gaz à effet
de serre depuis 1990, avec une diminution modeste depuis 2010 pour les
pays de l'OCDE. Cette pollution atmosphérique a des impacts
significatifs, notamment sur la santé et le réchauffement climatique.
Selon le GIEC, pour limiter le réchauffement à 1,5 ou 2 degrés, les
émissions doivent cesser rapidement. Une transition énergétique
simultanée de tous les secteurs, avec l'arrêt du soutien à la production
et à la consommation de combustibles fossiles, est nécessaire.

Pour les pays hors OCDE, seules des informations sur les émissions
autres que le CO2 sont disponibles. La diminution des gaz à effet de
serre pour les pays de l'OCDE est due à la délocalisation des activités
polluantes. Dans les années 1995, une forte augmentation pour ces pays
est marquée par une diminution correspondante pour les pays de l'OCDE.

Outre des émissions de GES plus élevées, certains pays comme les BRIICS
n'ont pas le même cadre sanitaire que les pays qui délocalisent. La
pollution atmosphérique étant particulièrement répandue dans
l'industrialisation des pays en développement, l'accès difficile aux
soins peut avoir des conséquences désastreuses.

Nous allons maintenant analyser un potentiel lien de corrélation entre
le taux de mortalité et la croissance de la population urbaine.

```{r}
#OCDE
mortalité_PM25_pop_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Croissance de la population (% annuel)","Mortalité due à l'exposition aux PM2.5","Croissance de la population urbaine (% annuel)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

mortalité_PM25_pop_OCDE <- mortalité_PM25_pop_OCDE %>% mutate(taux_mortalite_PM25 = (`Mortalité due à l'exposition aux PM2.5`- lag(`Mortalité due à l'exposition aux PM2.5`))*100/lag(`Mortalité due à l'exposition aux PM2.5`))

reg_mortalite_PM25_OCDE=lm('taux_mortalite_PM25 ~ `Croissance de la population urbaine (% annuel)`', data = mortalité_PM25_pop_OCDE)
summary(reg_mortalite_PM25_OCDE)
ggplot(reg_mortalite_PM25_OCDE, aes(x = `Croissance de la population urbaine (% annuel)`,y = taux_mortalite_PM25)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Correlation entre le taux de mortalité due à l'exposition au PM2.5 \n par rapport au taux de croissance de la population urbaine (%) ", x = "Croissance de la population urbaine (% annuel)", y = "taux de Mortalité due à l'exposition aux PM2.5")



#non OCDE
mortalité_PM25_pop_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("Croissance de la population (% annuel)","Mortalité due à l'exposition aux PM2.5","Croissance de la population urbaine (% annuel)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

mortalité_PM25_pop_non_OCDE_taux <- mortalité_PM25_pop_non_OCDE %>% mutate(taux_mortalite_PM25_non_OCDE = (`Mortalité due à l'exposition aux PM2.5`- lag(`Mortalité due à l'exposition aux PM2.5`))*100/lag(`Mortalité due à l'exposition aux PM2.5`))

reg_mortalite_PM25_non_OCDE_taux=lm('taux_mortalite_PM25_non_OCDE ~ `Croissance de la population urbaine (% annuel)`', data = mortalité_PM25_pop_non_OCDE_taux)
summary(reg_mortalite_PM25_non_OCDE_taux)
ggplot(reg_mortalite_PM25_non_OCDE_taux, aes(x = `Croissance de la population urbaine (% annuel)`,y = taux_mortalite_PM25_non_OCDE)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Correlation entre le taux de mortalité due à l'exposition au PM2.5 \n par rapport au taux de croissance de la population urbaine (%) ", x = "Croissance de la population urbaine (% annuel)", y = "taux de Mortalité due à l'exposition aux PM2.5")


```

Les résultats de la régression linéaire pour les pays de l'OCDE montrent
une relation statistiquement significative entre les deux variables.
Concrètement, une augmentation unitaire du taux de croissance de la
population urbaine est associée à une augmentation attendue de 0,2203
unité du taux de mortalité. Cependant, le faible R-squared de 0,003925
indique que cette variation de la croissance de la population explique
seulement une petite partie de la variabilité du taux de mortalité.

De manière similaire, pour les pays hors OCDE, une corrélation
statistiquement significative est observée entre les deux variables. Une
augmentation unitaire du taux de croissance est associée à une
diminution attendue de 0,04564 du taux de mortalité dû au PM2.5.
Cependant, la R-squared, encore plus faible que pour l'OCDE, indique que
la croissance de la population urbaine explique seulement une infime
partie du taux de mortalité lié au PM2.5. Cette disparité peut
s'expliquer par les conditions sanitaires dramatiques dans les pays
pauvres, où l'exposition aux particules n'est qu'un facteur parmi tant
d'autres.

Malgré cela, la pollution de l'air reste la principale cause
environnementale de décès prématurés, favorisant le développement de
maladies respiratoires et de cancers. Cela entraîne également une
augmentation des dépenses médicales. Un écart significatif persiste dans
l'accès aux soins selon les pays.

## **B- Politiques Environnementales**

Après avoir pu observer les pressions exercées par les composantes de
notre activité économique, nous allons pouvoir nous intéresser aux
politiques mises en place pour les réguler.

Une taxe environnementale est caractérisée par son action sur les coûts
des activités ou les prix des produits qui ont un effet négatif sur
l'environnement. C'est une internalisation de l'externalité négative.La
taxe carbone est la plus utilisée, elle taxe les émissions de dioxyde de
carbone, le gaz à effet de serre qui contribue majoritairement à la
détérioration du capital naturel.

```{r}

library(ggplot2)
library(tidyr)

#pour OCDE
OCDE_pays_Taxes <- OCDE_pays %>%
  filter(Variable == "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_Taxes <- non_OCDE_pays%>%
  filter(Variable == "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Fusion des deux bases de données 

merged_Taxes <- bind_rows(OCDE_pays_Taxes, non_OCDE_pays_Taxes)

ggplot(merged_Taxes, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Recettes provenant des taxes liées à l'énergie, % recettes \n des taxes environnementales",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()
```

Le graphique des recettes issues des taxes liées à l'énergie montre que
le taux pour les pays de l'OCDE est nettement plus élevé, restant stable
autour de 70%, tandis que les pays hors OCDE ont connu une croissance
asymptomatique jusqu'à un pic entre 2010 et 2015, dépassant les 50%. Les
recettes plus élevées de l'OCDE permettent la mise en place de mesures
environnementales significatives. L'innovation technologique,
essentielle pour une économie plus durable, est freinée par des défis
tels que la compétitivité entre les entreprises. Une analyse du lien
potentiel entre le développement des technologies environnementales et
les recettes des taxes liées à l'énergie serait pertinente.

```{r}
#OCDE
Dévelop_recette_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 


reg_Dévelop_recette_OCDE <- lm(`Développement de technologies liées à l'environnement, % inventions dans le monde` ~ `Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales`, data = Dévelop_recette_OCDE)

summary(reg_Dévelop_recette_OCDE)


ggplot(reg_Dévelop_recette_OCDE, aes(x = `Développement de technologies liées à l'environnement, % inventions dans le monde`,y = `Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales`)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Correlation entre le développement de technologies liées à l'environnement \n et les recettes provenant des taxes liées à l'énergie - OCDE", x = "Développement de technologies liées à l'environnement, % inventions dans le monde", y = "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")



#Non OCDE
Dévelop_recette_non_OCDE <-  non_OCDE_pays %>% filter(Variable %in% c("Développement de technologies liées à l'environnement, % inventions dans le monde", "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

reg_Dévelop_recette_non_OCDE <- lm(`Développement de technologies liées à l'environnement, % inventions dans le monde` ~ `Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales`, data = Dévelop_recette_non_OCDE)

summary(reg_Dévelop_recette_non_OCDE)


ggplot(reg_Dévelop_recette_non_OCDE, aes(x = `Développement de technologies liées à l'environnement, % inventions dans le monde`,y = `Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales`)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Correlation entre le développement de technologies liées à l'environnement \n et les recettes provenant des taxes liées à l'énergie - non OCDE", x = "Développement de technologies liées à l'environnement, % inventions dans le monde", y = "Recettes provenant des taxes liées à l'énergie, % recettes des taxes environnementales")
                                     

```

Pour les deux groupes (OCDE, hors OCDE), la relation entre les recettes
issues des taxes et le développement des technologies environnementales
n'est pas statistiquement significative et est même négative. Une
augmentation des recettes ne semble pas entraîner une amélioration
linéaire du développement technologique. Bien que les taxes puissent
influencer l'incitation à l'innovation pour une transition durable, la
corrélation directe n'est pas évidente.

Selon l'OCDE, des investissements conséquents en R&D pourraient réduire
de moitié le coût de cette transition. L'investissement public est
essentiel, et une coopération internationale, surtout pour les pays en
développement, est nécessaire pour atténuer les disparités existantes.

En transitionnant de la discussion sur les investissements en R&D et la
coopération internationale vers l'examen des subventions, nous passons
du niveau macro-économique aux mécanismes spécifiques de soutien aux
entreprises. Alors que les investissements en R&D sont identifiés comme
un levier clé pour faciliter la transition écologique, l'efficacité des
subventions dans cette démarche est une question plus détaillée.

Les subventions peuvent jouer un rôle significatif dans l'encouragement
des entreprises à adopter des pratiques plus durables, mais il est
crucial d'évaluer leur impact réel. Certaines subventions peuvent
contribuer positivement à la transition, tandis que d'autres pourraient
avoir des effets contraires. En examinant l'évolution de ces subventions
à travers diverses variables, nous chercherons à mieux comprendre
comment ces incitations financières peuvent influencer concrètement le
chemin vers des énergies plus durables.

```{r}
library(ggplot2)
library(tidyr)

#OCDE
OCDE_pays_subvention <- OCDE_pays %>%
  filter(Variable == "Soutien total aux combustibles fossiles, % recettes totales des taxes" ) %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention <- non_OCDE_pays%>%
  filter(Variable == "Soutien total aux combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Fusion des deux bases de données

merged_subvention <- bind_rows(OCDE_pays_subvention, non_OCDE_pays_subvention)

ggplot(merged_subvention, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien total aux combustibles fossiles, % recettes totales des taxes",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()


# Nouveau graph pour les subvention pour les consommateur de combustibles fossiles


#pour OCDE
OCDE_pays_subvention_consommateur <- OCDE_pays %>%
  filter(Variable == "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention_consommateur <- non_OCDE_pays%>%
  filter(Variable == "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_data_subvention_consommateur <- bind_rows(OCDE_pays_subvention_consommateur, non_OCDE_pays_subvention_consommateur)

ggplot(merged_data_subvention_consommateur, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien aux consommateurs de combustibles fossiles, % recettes totales des taxes",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()




#Nouveau graph pour Soutien à l'électricité, % soutien total aux combustibles fossiles


#pour OCDE
OCDE_pays_subvention_éléctricité <- OCDE_pays %>%
  filter(Variable == "Soutien à l'électricité, % soutien total aux combustibles fossiles") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

#Non OCDE
non_OCDE_pays_subvention_éléctricité <- non_OCDE_pays%>%
  filter(Variable == "Soutien à l'électricité, % soutien total aux combustibles fossiles") %>%
  pivot_longer(cols = c(`1990`, `1991`, `1992`, `1993`, `1994`, `1995`, `1996`, `1997`, `1998`, `1999`, `2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`, `2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),
               names_to = "Année",
               values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Merged data 

merged_subvention_éléctricité <- bind_rows(OCDE_pays_subvention_éléctricité, non_OCDE_pays_subvention_éléctricité)

ggplot(merged_subvention_éléctricité, aes(x = as.numeric(Année), y = Value, color = Groupe)) +
  geom_smooth(method = "loess", se = FALSE, na.rm = TRUE)+
  labs(title = "Soutien à l'électricité, % soutien total aux combustibles fossiles",
       x = "Année",
       y = "Recettes en %") +
  theme_minimal()




```

Les subventions aux combustibles fossiles entravent les efforts vers une
transition durable, malgré une diminution constante, surtout pour les
pays hors OCDE après le pic de 2012. Les subventions à l'électricité,
bien que nécessaires à 41% pour les ménages, sont majoritairement
produites par des combustibles fossiles (47,2%), posant un défi pour les
politiques climatiques du FMI et de la Banque Mondiale, qui cherchent à
les supprimer en faveur d'alternatives plus durables. Cependant, la
volatilité des prix de l'énergie et le manque d'accès à l'électricité
pour 760 millions de personnes compliquent la réduction de ces
subventions. Des solutions alternatives, telles que l'énergie verte,
doivent être explorées pour atteindre les objectifs climatiques
mondiaux.

Pour autant certaines mesures sont prises telles que la protection des
zones terrestres et marines.

```{r}
# pour Zones protégées (% du territoire total)

OCDE_zones_protégées_totales <- OCDE_pays %>%
  filter(Variable == "Zones protégées à l'échelle nationale (% du territoire total)") %>%
  pivot_longer(cols = `2016`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

non_OCDE_zones_protégées_totales <- non_OCDE_pays %>%
  filter(Variable == "Zones protégées à l'échelle nationale (% du territoire total)") %>%
  pivot_longer(cols = `2016`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

# Fusion des deux bases de données
merged_zones_protégées <- bind_rows(OCDE_zones_protégées_totales, non_OCDE_zones_protégées_totales)


average_zones_protégées <- merged_zones_protégées %>%
  group_by(Année, Groupe) %>%
  summarize(Average_Value = mean(Value, na.rm = TRUE), .groups = 'drop')


ggplot(average_zones_protégées, aes(x = as.factor(Année), y = Average_Value, fill = Groupe)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7, na.rm = TRUE) +
  labs(title = "Moyenne des zones protégées à l'échelle nationale (% du territoire total)",
       x = "Année",
       y = "Pourcentage moyen des zones protégées") +
  theme_minimal()


# pour Zones terrestres et marines protégées (% du territoire total)

OCDE_terrestres_marines_protégées_totales <- OCDE_pays %>%
  filter(Variable == "Zones terrestres et marines protégées (% du territoire total)") %>%
  pivot_longer(cols = `2016`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

non_OCDE_terrestres_marines_protégées_totales <- non_OCDE_pays %>%
  filter(Variable == "Zones terrestres et marines protégées (% du territoire total)") %>%
  pivot_longer(cols = `2016`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

# Fusion des deux bases de données
merged_terrestres_marines_protégées <- bind_rows(OCDE_terrestres_marines_protégées_totales, non_OCDE_terrestres_marines_protégées_totales)

average_terrestres_marines <- merged_terrestres_marines_protégées %>%
  group_by(Année, Groupe) %>%
  summarize(Average_Value = mean(Value, na.rm = TRUE), .groups = 'drop')


ggplot(average_terrestres_marines , aes(x = as.factor(Année), y = Average_Value, fill = Groupe)) +
  geom_bar(stat = "identity", position = "dodge", width = 0.7, na.rm = TRUE) +
  labs(title = "Moyenne des zones terrestres et marines protégées à l'échelle nationale \n (% du territoire total)",
       x = "Année",
       y = "Pourcentage moyen des zones terrestres et marines protégées") +
  theme_minimal()

```

Notre graphe commence en 2016, car il n'y a pas de donnée avant cette
date. Les zones protégées, comprenant des sites cruciaux pour la
biodiversité, ne cessent d'augmenter depuis 2015 à l'échelle mondiale.
Elles jouent un rôle essentiel dans la conservation des espèces et des
moyens de subsistance, reflétant une prise de conscience mondiale sur la
nécessité de préserver les ressources naturelles. Les graphiques
indiquent une moyenne plus élevée des zones protégées pour les pays
membres de l'OCDE. Toutefois, selon le pays, les zones sont plus ou
moins difficiles à protéger.En Amazonie par exemple où le président du
Brésil laisse porte ouverte aux industriels, car elle represente un des
atouts majeurs pour s'enrichir et développer le pays, il est compliqué
de rendre complétement protégée cette mine d'or.

# **III- Vulnérabilités et stratégies adaptives**

## **A- Variables démographiques**

La migration des populations vers les espaces urbains s'est réalisée de
manière continue depuis l'industrialisation au 19ᵉ siècle. Depuis 2007,
la population urbaine est plus nombreuse que la population rurale. D'ici
2030, les citadins représenteront 60% de la population. Nous allons
analyser ces migrations dans un graphique afin de nous rendre compte de
ces évolutions. La Banque mondiale dispose de plus de variables sur les
indices urbains, tandis que l'OCDE est davantage axée sur les
migrations, ce qui nous permettra d'avoir un large éventail de données.

```{r}
#OCDE
OCDE_pop_urbaine <- OCDE_pays %>%
  filter(Variable == "Population urbaine (% du total)") %>%
  pivot_longer(cols = `1990`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

non_OCDE_pop_urbaine <- non_OCDE_pays %>%
  filter(Variable == "Population urbaine (% du total)") %>%
  pivot_longer(cols = `1990`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Fusion des deux bases de données
merged_pop_urbaine <- bind_rows(OCDE_pop_urbaine, non_OCDE_pop_urbaine)

average_pop_urbaine <-merged_pop_urbaine %>%
  group_by(Année, Groupe) %>%
  summarize(Average_pop_urbaine = mean(Value, na.rm = TRUE), .groups = 'drop')

OCDE_migration <- OCDE_pays %>%
  filter(Variable == "Migration nette") %>%
  pivot_longer(cols = `1990`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")



ggplot(average_pop_urbaine, aes(x = as.factor(Année), y = Average_pop_urbaine, group = Groupe, color = Groupe)) +
  geom_line(size = 2) +
  geom_point(size = 3) +
  labs(title = "Évolution de la population urbaine (% du total) par groupe",
       x = "Année",
       y = "Pourcentage moyen de la population urbaine") +
  theme_minimal() +
  scale_color_manual(values = c("OCDE" = "lightseagreen", "non_OCDE" = "#FF6666")) +
  theme(legend.position = "top")+
   theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5))
```

A travers ce graphique, nous pouvons confirmer l'augmentation de la
population urbaine depuis les années 1990, avec une disparité notable
entre les pays de l'OCDE et hors OCDE. En moyenne, la population urbaine
des pays hors OCDE atteint environ 80% en 2020, tandis que pour l'autre
groupe, elle est seulement de 58%. Cette différence s'explique par le
fait que certains pays atteignent un taux d'urbanisation proche, voire à
100%, comme le Koweït qui n'est pas dans l'OCDE.

```{r}
#OCDE
OCDE_migration <- OCDE_pays %>%
  filter(Variable == "Migration nette") %>%
  pivot_longer(cols = `1990`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "OCDE")

non_OCDE_migration <- non_OCDE_pays %>%
  filter(Variable == "Migration nette") %>%
  pivot_longer(cols = `1990`:`2020`, names_to = "Année", values_to = "Value") %>%
  mutate(Value = as.numeric(Value), Groupe = "non_OCDE")

#Fusion des deux bases de données
merged_migration <- bind_rows(OCDE_migration, non_OCDE_migration)

ggplot(merged_migration, aes(x = as.factor(Année), y = Value, fill = Groupe)) +
  geom_bar(stat = "identity", position = "stack", width = 0.7) +
  labs(title = "Évolution de la migration nette par groupe",
       x = "Année",
       y = "Migration Nette") +
  theme_minimal() +
  scale_fill_manual(values = c("OCDE" = "lightseagreen", "non_OCDE" = "#FF6666")) +
  facet_wrap(~Groupe, scales = "free_y", ncol = 1) +
  theme(legend.position = "top")+
   theme(axis.text.x = element_text(angle = 50, size = 8, vjust = 0.5))

```

L'analyse de l'immigration nette pour 1 million d'habitants offre des
insights sur la dynamique démographique et migratoire. Les tendances
sont à la hausse pour l'OCDE, tandis que pour l'autre groupe, la
migration atteint parfois des valeurs négatives, indiquant un excédent
de départs par rapport aux arrivées. La hausse de l'immigration de
travail dans l'OCDE contribue à cette tendance, tandis que les raisons
humanitaires et les conflits sont des facteurs conduisant à l'exode des
populations hors OCDE.

```{r}
#OCDE
migration_eau_OCDE <-  OCDE_pays %>% filter(Variable %in% c("Prélèvements bruts d'eau douce par habitant", "Migration nette")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 


reg_migration_eau_OCDE <- lm(`Prélèvements bruts d'eau douce par habitant` ~ `Migration nette`, data = migration_eau_OCDE)

summary(reg_migration_eau_OCDE)


ggplot(reg_migration_eau_OCDE, aes(x = `Prélèvements bruts d'eau douce par habitant`,y = `Migration nette`)) + geom_point(color='gray', size=1, na.rm = TRUE) + geom_smooth(method='lm', formula = 'y ~ x', se=FALSE, color='red', na.rm = TRUE) + theme_minimal() + labs(title = "Correlation entre la migration nette et les prélevements bruts d'eau douce \n par habitant - OCDE", x = "Prélèvements bruts d'eau douce par habitant", y = "Migration nette")



```

Le test statistique entre migration nette et prélèvements bruts d'eau
douce par habitant indique une association, mais les faibles valeurs de
R-squared et de la p-value soulignent que le modèle explique seulement
partiellement les variations. Malgré un lien entre la hausse de la
migration et l'accroissement des pressions environnementales, ce lien
est limité. Les conditions climatiques extrêmes rendent inévitable la
migration forcée, prévoyant 216 millions de personnes contraintes de
migrer à l'intérieur de leur pays d'ici 2050. Une réduction des
émissions de gaz à effet de serre pourrait atténuer ces migrations de
80%.

*B- vulnérabilité humaine face aux changement climatiques*
L'industrialisation intensives qui a lieu depuis le 19 ieme siècle et la
consommation de masse des 30 glorieuses n'a pas laissé notre planète
indemne. En effet, les catastrophes naturelles se multiplient et nous
sommes totalement vulnérable face à cet nature déchainé.

```{r}
vulnerabilite_OCDE <- OCDE_pays %>% filter(Variable %in% c("Pourcentage de la population exposée aux journées glacées","Pourcentage de la population exposée aux journées chaudes","Pourcentage de la population exposée aux incendies incontrôlés","Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)","Stress hydrique, total des prélèvements d'eau douce en % des ressources internes renouvelables","Population, total")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

vulnarabilite_OCDE_growth <- vulnerabilite_OCDE %>% filter(Pays%in%unique(decoupling_CO2_OCDE$Pays)) %>% group_by(Année, Pays) %>% summarise(population_exposée_aux_journées_glacées = (`Pourcentage de la population exposée aux journées glacées`*`Population, total`),population_exposée_aux_journées_chaudes = (`Pourcentage de la population exposée aux journées chaudes`*`Population, total`), population_exposée_aux_incendies_incontrôlés = (`Pourcentage de la population exposée aux incendies incontrôlés`*`Population, total`), Population = `Population, total`, .groups = 'drop')

vulnarabilite_OCDE_growth <- vulnarabilite_OCDE_growth  %>% group_by(Année) %>% summarise(somme_population_exposée_aux_journées_glacées = sum(`population_exposée_aux_journées_glacées`, na.rm = TRUE),somme_population_exposée_aux_journées_chaudes = sum(`population_exposée_aux_journées_chaudes`, na.rm = TRUE), somme_population_exposée_aux_incendies_incontrôlés = sum(`population_exposée_aux_incendies_incontrôlés`,na.rm = TRUE), somme_Population = sum(`Population`,na.rm = TRUE))

vulnarabilite_OCDE_growth <- vulnarabilite_OCDE_growth %>% mutate(part_population_exposée_aux_journées_glacées = (`somme_population_exposée_aux_journées_glacées`/`somme_Population`), part_population_exposée_aux_journées_chaudes = (`somme_population_exposée_aux_journées_chaudes`/`somme_Population`),part_population_exposée_aux_incendies_incontrôlés = (`somme_population_exposée_aux_incendies_incontrôlés`/`somme_Population`))

vulnarabilite_OCDE_growth<- vulnarabilite_OCDE_growth %>% pivot_longer(cols = c(part_population_exposée_aux_incendies_incontrôlés,part_population_exposée_aux_journées_chaudes,part_population_exposée_aux_journées_glacées), names_to = "Variable", values_to = "Taux") 

ggplot(vulnarabilite_OCDE_growth, aes(x = Année, y = Taux, color = Variable, linetype = Variable, group = Variable)) + geom_point(na.rm = TRUE)  + geom_line(na.rm = TRUE) + labs(title = "Part de la population de l'OCDE exposée aux incendies incontrôlées, \n aux journées chaudes  et aux journées glacées", x = "Année", y = "Taux (%)", color = "Variable") +  theme(axis.text.x=element_text(angle=50, size=8, vjust=0.5)) +   geom_smooth(method = 'loess',formula = 'y ~ x' , alpha = 0.3, linewidth = 0.5, se = FALSE, color = 'black')



```

Au sein des pays membres de l'OCDE nous constatons que la part de la
population exposée aux journées chaudes à particulièrement augmentées.
En effet bien qu'il y ait de fortes variations entre les années, la
tendance montre une nette augmentation entre 1990 et 2020 d'un peu plus
de 25% à un peu moins de 40%. Pour ce qui est de la part de la
populaition exposée aux journées glacées, il n'y a pas eu de fort
changement durant c'est 30 dernières. Enfin, sur la part de la
population exposée aux incendies, il n'y a pas de valeurs avant 2000,
donc on ne peut pas interpréter les valeurs entre 1990 et 2000, de plus
entre 2000 et 2020 on constate une tendance constante. Nous ne possedons
pas de valeurs pour les pays non membres de l'OCDE, toutefois la
variables Sécheresses, inondations, températures extrêmes (en % de la
population, moyenne de 1990 à 2009) nous permet d'effectuer des
comparaisons entre les pays membres et non-membres de l'OCDE

```{r}
#Sécheresses, inondations, températures extrêmes (en % de la population, moyenne de 1990 à 2009)
risque_OCDE <- OCDE_pays %>% filter(Variable %in% c("Sécheresses, inondations, températures extrêmes (en % de la population, moyenne de 1990 à 2009)")) %>% select(-`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

risque_non_OCDE <- non_OCDE_pays %>% filter(Variable %in% c("Sécheresses, inondations, températures extrêmes (en % de la population, moyenne de 1990 à 2009)")) %>% select(-`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 

risque <- bind_rows(mutate(risque_OCDE, Group = "OCDE"),mutate(risque_non_OCDE, Group = "Non-OCDE"))
risque <- risque %>% filter(Pays%in%unique(risque$Pays)) %>% group_by(Pays, Group, COU) %>% summarise(Secheresses_inondations_temperatures_extreme = `Sécheresses, inondations, températures extrêmes (en % de la population, moyenne de 1990 à 2009)`[Année == 2009], .groups = 'drop')



```

```{r}
ggplot(risque, aes(x = Group, y = Secheresses_inondations_temperatures_extreme, fill = Group)) +
  geom_boxplot(na.rm = TRUE, alpha = 0.8)  +  scale_fill_manual(values = c("Non-OCDE" = "skyblue", "OCDE" = "lightcoral"))  + theme_minimal() + labs(title = "% de la population de chaque pays exposée aux Sécheresses,\n inondations, températures extrêmes (1990-2009)", x = "Groupe", y = "Population de chaque pays exposée aux risques (%)") 
  
```

Par ailleurs, en 2011 certains pays du monde ont été évalué note sur les
progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5
étant la meilleure note)

```{r}

note_progres_non_OCDE <- non_OCDE_pays %>% filter(Variable %in% c("Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)")) %>% select(-`COU`, -`VAR` ,- `Unit`, -`PowerCode`) %>% pivot_longer(cols = c(`1990`,`1991`,`1992`,`1993`,`1994`,`1995`,`1996`,`1997`,`1998`,`1999`,`2000`, `2001`, `2002`, `2003`, `2004`, `2005`, `2006`, `2007`, `2008`, `2009`,`2010`, `2011`, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`, `2019`, `2020`),  names_to = "Année", values_to = "Value") %>% mutate(Value = as.numeric(Value)) %>% pivot_wider(names_from = Variable, values_from = Value) 


vulnerabilite_OCDE_clean_progres <- drop_na(vulnerabilite_OCDE,`Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`) %>% select(`Pays`,`Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`) %>% mutate(Group = "OCDE")

note_progres_non_OCDE <- drop_na(note_progres_non_OCDE,`Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`) %>% select(`Pays`,`Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`)  %>% mutate(Group = "Non-OCDE")

note_progres_fusion <- bind_rows(vulnerabilite_OCDE_clean_progres, note_progres_non_OCDE)

ggplot(note_progres_fusion, aes(y = reorder(Pays,`Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`),x = `Note sur les progrès de réduction des risques de catastrophes (échelle de 1 à 5, 5 étant la meilleure note)`,  fill = Group)) + geom_bar(stat ="identity", position = "dodge", na.rm = TRUE, width =  0.7) +  theme(axis.text.y = element_text(size = 5),plot.title = element_text(hjust = 0.1)) + labs(title = "Note sur les progrès de réduction des risques de catastrophes\n (échelle de 1 à 5, 5 étant la meilleure note)", y = "Pays", x = "note sur les progrès de\n réduction des risques de catastrophes") +  scale_fill_manual(values = c("OCDE" = "blue", "Non-OCDE" = "red")) 




```

ii. Examiner les variables en lien avec les zones en-dessous d'une
    certaine altitudes ou à proximité du niveau de la mer et leur
    vulnérabilité sur la hausse des niveaux des océans.

Superficie des terres dont l'altitude est inférieure à 5 mètres (en % de
la superficie totale des terres) Zones urbaines dont l'altitude est \< à
5 m (% de la superficie totale) Population vivant sur des terres dont
l'altitude est inférieure à 5 mètres (en % de la population totale)
Hauteur moyenne des précipitations (mm par an)

```{r}
# Hauteur moyenne des précipitations (mm par an)

```

# **Conclusion**

Entre 1990 et 2020, la transition écologique a engendré des disparités
marquées entre les pays de l'OCDE et les autres. Bien que certains pays
de l'OCDE aient réussi à découpler la croissance économique des
émissions de CO2, des défis persistent, particulièrement pour les pays
hors OCDE. Les pressions environnementales, mesurées par les
prélèvements d'eau douce, affichent des corrélations variables avec les
migrations nettes, soulignant la nécessité d'approches spécifiques.

Les migrations ont suivi des tendances divergentes, avec une
urbanisation croissante hors OCDE et des migrations nettes positives
dans l'OCDE, largement motivées par l'immigration de travail. Les
impacts des changements climatiques se traduisent par une vulnérabilité
croissante dans les pays de l'OCDE, en particulier face aux journées
chaudes.

En résumé, la transition écologique dévoile des parcours différents
entre les deux groupes de pays. Les défis environnementaux et
climatiques exigent des approches adaptées, tant dans l'OCDE que hors de
cette organisation. La collaboration internationale demeure cruciale
pour instaurer une transition écologique globale, équitable et efficace.

## Bibliographie

Organisation de Coopération et de Développement Économiques (OCDE).
(2012). Perspectives de l'environnement de l'OCDE à l'horizon 2050. OECD
Publishing.
<https://read.oecd-ilibrary.org/environment/perspectives-de-l-environnement-de-l-ocde-a-l-horizon-2050_env_outlook-2012-fr#page15>

Banque mondiale. (2021, 13 septembre). Le changement climatique pourrait
contraindre 216 millions de personnes à migrer à l'intérieur de leur
propre pays d'ici 2050. Communiqué de presse.
<https://www.banquemondiale.org/fr/news/press-release/2021/09/13/climate-change-could-force-216-million-people-to-migrate-within-their-own-countries-by-2050>

OCDE. (année). Exposition à la pollution de l'air \[Graphique\].
Data.OECD.
<https://data.oecd.org/fr/air/exposition-a-la-pollution-de-l-air.htm#indicator-chart>

Santé Publique France. (année). Impacts de l'exposition chronique aux
particules fines sur la mortalité en France continentale et analyse des
gains en santé de plusieurs scénarios \[Rapport de synthèse\].
<https://www.santepubliquefrance.fr/determinants-de-sante/pollution-et-sante/air/documents/rapport-synthese/impacts-de-l-exposition-chronique-aux-particules-fines-sur-la-mortalite-en-france-continentale-et-analyse-des-gains-en-sante-de-plusieurs-scenarios>

Alternatives Économiques. (2017, 1er février). Population urbaine et
population rurale dans le monde : les milliards de projections selon le
scénario médian.
<https://www.alternatives-economiques.fr/population-urbaine-population-rurale-monde-milliards-projections-selon-scenario-median-0102201777461.html>
